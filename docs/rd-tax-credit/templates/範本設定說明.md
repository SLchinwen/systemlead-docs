# ref.docx 範本設定說明（排版、標題、縮排、表格框線）

本說明讓大家能依**政府附件1-研發計畫重點摘要書**的排版、標題、縮排建立共用範本。

---

## 可以直接用原檔當範本嗎？

**可以。** 把政府提供的「附件1-研發計畫重點摘要書(中小企業).docx」**直接**複製到本目錄並命名為 **ref.docx** 即可，**不必先做任何 Word 設定**。Pandoc 會套用該檔的標題、內文、縮排等樣式。

若**轉出後發現字型排列與 ref.docx 不同、或表格沒有框線**，請依下方 **「二、產出與 ref.docx 不同時：字型排列與表格框線」** 在 Word 裡調整 ref.docx 的樣式（標題／內文字型、表格框線）後儲存，再重新轉出即可。

---

## 項次編號要不要對照範本重做？

**目前不必。** 計畫書的 Markdown（`plans/2025/2025_年度研發投資抵減_完整計畫書.md`）已依政府計畫格式範本（`templates/年度研發投資抵減計畫書（政府計畫格式）.md`）撰寫，項次為：

- 章：**一、二、三 … 十、附錄**
- 第六章子項：**（一）（二）（三）（四）**

與政府常用格式一致，**不需重新產生項次編號**。轉出 DOCX 時，Pandoc 會沿用 Markdown 標題文字（含「一、」「二、」等），並套用 ref.docx 的字型與段落樣式。

若您手上的 **ref.docx（附件1）** 使用不同編號（例如壹貳參、或 1. 2. 3.）：

- **做法 A**：在 Word 開啟 ref.docx，將「標題 1／標題 2」的大綱編號設成「一、二、三…」與「（一）（二）…」，儲存後轉出即會一致。
- **做法 B**：若希望 MD 完全配合 Word 的編號，請告訴我們 ref.docx 實際使用的項次格式，再依該格式調整 Markdown 標題。

---

## 一、建立 ref.docx（第一次設定）

### 方式 A：用腳本複製（建議）

1. 確認政府提供的檔案路徑，例如：  
   `C:\Users\sl-ch\OneDrive - SystemLead Tech CO\文件\附件1-研發計畫重點摘要書(中小企業)(1).docx`
2. 若路徑不同，用編輯器開啟 **`docs\rd-tax-credit\Setup-RefTemplate.ps1`**，修改裡面的 `$sourcePath`。
3. 在 PowerShell 於**專案根目錄**執行：
   ```powershell
   .\docs\rd-tax-credit\Setup-RefTemplate.ps1
   ```
   腳本會把該檔案複製到 `docs\rd-tax-credit\templates\ref.docx`。

### 方式 B：手動複製

1. 將 **附件1-研發計畫重點摘要書(中小企業).docx** 複製到 `docs\rd-tax-credit\templates\`。
2. 重新命名為 **`ref.docx`**。

---

## 二、產出與 ref.docx 不同時：字型排列與表格框線

若轉出的 DOCX **字型排列與 ref.docx 不同**、或**表格沒有框線**，代表 Pandoc 套用的樣式與 ref.docx 不一致。請在 Word 裡**手動調整 ref.docx 的樣式**後再存檔，然後重新執行 輸出DOCX.bat。

### 2.1 讓字型、段落與 ref.docx 一致

Pandoc 會套用 ref.docx 中 **標題 1、標題 2、標題 3、內文（正文）** 等樣式的字型、大小、行距。請在 Word 中：

1. 開啟 **ref.docx**。
2. **常用** → **樣式**（或 **樣式** 窗格）→ 找到 **標題 1**、**標題 2**、**內文**（或 **正文**）。
3. 在每個樣式上**右鍵 → 修改**，設定您要的字型、字級、行距、與前後段距離，使版面與政府格式一致。
4. 若政府附件1 的標題／內文已用這些樣式，理論上不需改；若附件1 用的是「手動」格式而非樣式，請先將 ref.docx 內一段標題、一段內文**套用「標題 1」「內文」樣式**，再修改該樣式，這樣 Pandoc 轉出時才會套用。
5. **儲存** ref.docx。

### 2.2 讓表格有框線（與 ref.docx 一致）

Pandoc 轉出的表格會套用 ref.docx 的**表格樣式**。若 ref.docx 沒有「帶框線」的表格樣式，產出的表格就會沒有框線。請在 Word 中：

1. 開啟 **ref.docx**。
2. **若範本裡已有表格**：
   - 點選該表格 → **表格設計**（或 **表格工具**）→ **框線** 選 **「全部框線」**（或 **外框線 + 內框線**）。
   - 在 **表格設計** → **表格樣式** 中，選 **「表格格線」**（Table Grid）或任一**有框線**的樣式，讓此表格套用該樣式。
   - 若希望此樣式成為 Pandoc 預設套用：可將該樣式 **設成「更新以符合選取範圍」** 或 **另存為預設表格樣式**（依您的 Word 版本）。
3. **若範本裡沒有表格**：
   - **插入** → **表格** → 插入一個 2×2 小表格。
   - 點選該表格 → **表格設計** → **框線** → **全部框線**。
   - **表格樣式** 選 **「表格格線」**（或 網格表）。
   - 儲存後，Pandoc 會以此表格的樣式套用到轉出的所有表格。
4. **儲存** ref.docx 後關閉。

完成上述後，重新執行 **輸出DOCX.bat**，產出的字型排列與表格框線應會與 ref.docx 一致。

---

## 三、給大家參照使用

- **範本檔案**：就是 **`templates\ref.docx`**（由附件1 複製並依上面步驟設定框線後存檔）。
- **下載／取得方式**：
  - 若 ref.docx 已放入 repo：其他人 clone 或 pull 後即有範本，直接執行 輸出DOCX.bat 即可。
  - 若 ref.docx 不進版控（例如含個資）：請每位同仁依「一、二」自行用自己電腦的附件1 跑一次 Setup-RefTemplate.ps1，再在 Word 裡設定表格框線後存檔。

---

## 四、參考路徑整理

| 項目 | 路徑或檔名 |
|------|------------|
| 範本檔（程式用） | `docs\rd-tax-credit\templates\ref.docx` |
| 設定腳本 | `docs\rd-tax-credit\Setup-RefTemplate.ps1` |
| 轉出 DOCX | 雙擊 `docs\rd-tax-credit\輸出DOCX.bat`，產出在 `docx-output\` |

---

👉 若希望「每一份」轉出的 DOCX 都套用 ref.docx，可編輯 **`docx-file-list.txt`**，在要套用的那一行第三欄加上 `ref`。
