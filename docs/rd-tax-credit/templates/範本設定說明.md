# ref.docx 範本設定說明（排版、標題、縮排、表格框線）

本說明讓大家能依**政府附件1-研發計畫重點摘要書**的排版、標題、縮排建立共用範本。

---

## 可以直接用原檔當範本嗎？

**可以。** 把政府提供的「附件1-研發計畫重點摘要書(中小企業).docx」**直接**複製到本目錄並命名為 **ref.docx** 即可，**不必先做任何 Word 設定**。Pandoc 會套用該檔的標題、內文、縮排等樣式。

只有在**轉出後發現表格沒有框線**時，再依下方「二、在 Word 裡設定表格框線」用 Word 開啟 ref.docx 設定表格樣式並儲存即可。

---

## 項次編號要不要對照範本重做？

**目前不必。** 計畫書的 Markdown（`plans/2025/2025_年度研發投資抵減_完整計畫書.md`）已依政府計畫格式範本（`templates/年度研發投資抵減計畫書（政府計畫格式）.md`）撰寫，項次為：

- 章：**一、二、三 … 十、附錄**
- 第六章子項：**（一）（二）（三）（四）**

與政府常用格式一致，**不需重新產生項次編號**。轉出 DOCX 時，Pandoc 會沿用 Markdown 標題文字（含「一、」「二、」等），並套用 ref.docx 的字型與段落樣式。

若您手上的 **ref.docx（附件1）** 使用不同編號（例如壹貳參、或 1. 2. 3.）：

- **做法 A**：在 Word 開啟 ref.docx，將「標題 1／標題 2」的大綱編號設成「一、二、三…」與「（一）（二）…」，儲存後轉出即會一致。
- **做法 B**：若希望 MD 完全配合 Word 的編號，請告訴我們 ref.docx 實際使用的項次格式，再依該格式調整 Markdown 標題。

---

## 一、建立 ref.docx（第一次設定）

### 方式 A：用腳本複製（建議）

1. 確認政府提供的檔案路徑，例如：  
   `C:\Users\sl-ch\OneDrive - SystemLead Tech CO\文件\附件1-研發計畫重點摘要書(中小企業)(1).docx`
2. 若路徑不同，用編輯器開啟 **`docs\rd-tax-credit\Setup-RefTemplate.ps1`**，修改裡面的 `$sourcePath`。
3. 在 PowerShell 於**專案根目錄**執行：
   ```powershell
   .\docs\rd-tax-credit\Setup-RefTemplate.ps1
   ```
   腳本會把該檔案複製到 `docs\rd-tax-credit\templates\ref.docx`。

### 方式 B：手動複製

1. 將 **附件1-研發計畫重點摘要書(中小企業).docx** 複製到 `docs\rd-tax-credit\templates\`。
2. 重新命名為 **`ref.docx`**。

---

## 二、在 Word 裡設定「表格要有框線」

Pandoc 轉出 DOCX 時會套用 ref.docx 的**樣式**。若 ref.docx 裡的「表格」樣式有框線，轉出的表格就會有框線。

### 步驟（Word）

1. 用 Word 開啟 **`docs\rd-tax-credit\templates\ref.docx`**。
2. 若範本裡已有表格：點選該表格 → **表格設計**（或 **表格工具**）→ **框線** 設為「全部框線」或「外框線＋內框線」。
3. 把這個表格的樣式存成 Word 預設的表格樣式，讓 Pandoc 套用：
   - 點選表格 → 右鍵 **表格內容**（或 **表格屬性**）→ 確認框線已套用。
   - 或：**表格設計** → **表格樣式** → 選「表格格線」或任一有框線的樣式 → 若需要可「另存為表格樣式」。
4. **儲存** ref.docx 後關閉。

之後執行 **輸出DOCX.bat**，第一份計畫書 DOCX 會套用此 ref.docx 的**標題、內文、縮排與表格樣式**；表格會依 ref.docx 的表格框線設定顯示。

---

## 三、給大家參照使用

- **範本檔案**：就是 **`templates\ref.docx`**（由附件1 複製並依上面步驟設定框線後存檔）。
- **下載／取得方式**：
  - 若 ref.docx 已放入 repo：其他人 clone 或 pull 後即有範本，直接執行 輸出DOCX.bat 即可。
  - 若 ref.docx 不進版控（例如含個資）：請每位同仁依「一、二」自行用自己電腦的附件1 跑一次 Setup-RefTemplate.ps1，再在 Word 裡設定表格框線後存檔。

---

## 四、參考路徑整理

| 項目 | 路徑或檔名 |
|------|------------|
| 範本檔（程式用） | `docs\rd-tax-credit\templates\ref.docx` |
| 設定腳本 | `docs\rd-tax-credit\Setup-RefTemplate.ps1` |
| 轉出 DOCX | 雙擊 `docs\rd-tax-credit\輸出DOCX.bat`，產出在 `docx-output\` |

---

👉 若希望「每一份」轉出的 DOCX 都套用 ref.docx，可編輯 **`docx-file-list.txt`**，在要套用的那一行第三欄加上 `ref`。
